<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD iBatis Mapper 3.0 //EN" 
	"http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">

<mapper namespace="com.jeecg.p3.baseApi.dao.BaseApiJwidDao">

 	<!-- 查询二维码图片 -->
 	<select id="queryOneByJwid" parameterType="Object"  resultType="java.lang.String">
		SELECT 
			qrcodeimg
		FROM
			jw_web_jwid
		WHERE jwid=#{jwid}
	</select>
	
	<!-- 查询api凭证 -->
	<select id="queryTicketByJwid" parameterType="Object" resultType="java.lang.String">
		SELECT 
			apiticket
		FROM
			jw_web_jwid
		WHERE jwid=#{jwid}
	</select>

	<!-- 通过appid查询，查询第三方平台账号配置 -->
	<select id="queryOneByAppid" parameterType="Object"  resultType="com.jeecg.p3.baseApi.vo.OpenAccountVo">
		 SELECT
			woa.id
		   ,woa.appid                         /* appid */
		   ,woa.appsecret                     /* appsecret */
		   ,woa.ticket                        /* 第三方平台ticket */
		   ,woa.get_ticket_time               /* 第三方平台获取ticket时间 */
		   ,woa.component_access_token        /* 平台方access_token */
           ,woa.get_access_token_time         /* 平台方获取access_token时间 */
		 FROM   weixin_open_account      AS woa
		 WHERE
			woa.appid=#{appid}
			LIMIT 1
	</select>
	
	<!-- 根据公众号查询accessToken -->
	<select id="queryAccessTokenByJwid" parameterType="Object"  resultType="java.lang.String">
		    SELECT 
                   jwj.access_token                   /* access_token */ 
		FROM   	 jw_web_jwid      AS jwj      /*  */ 
		WHERE 
			jwj.jwid = #{jwid}
	</select>
	
	<!--
	方法名称: queryByJwid
	调用路径: com.jeecg.p3.system.entity.MyJwWebJwid.queryByJwid
	开发信息: 
	处理信息: 根据jwid查询信息
	-->
	<select id="queryByJwid" parameterType="Object" resultType="com.jeecg.p3.baseApi.vo.WinxinJwWebJwid">
	    SELECT 
             jwj.id                            /*  */ 
            ,jwj.jwid                          /* 公众号 */ 
            ,jwj.name                          /* 名称 */ 
            ,jwj.weixin_number				 /* 微信号 */
            ,jwj.weixin_appid					 /* 微信AppId */
            ,jwj.weixin_appsecret				 /* 微信AppSecret */
            ,jwj.account_type					 /* 公众号类型 */
            ,jwj.auth_status					 /* 是否认证 0不认证 1认证 */
            ,jwj.access_token					 /* AccessToken */
            ,jwj.token_gettime				 /* token获取时间 */
            ,jwj.apiticket					 /* api凭证*/
            ,jwj.apiticket_gettime             /* apiticket获取时间*/
            ,jwj.jsapiticket					 /* jsapiticket*/
            ,jwj.jsapiticket_gettime 			 /* jsapiticket获取时间*/
            ,jwj.auth_type                     /*类型：1手动授权，2扫码授权*/
            ,jwj.business_info                 /* 功能的开通状况：1代表已开通*/
            ,jwj.func_info                     /* 公众号授权给开发者的权限集*/
            ,jwj.nick_name                     /* 授权方昵称*/
            ,jwj.headimgurl                    /* 授权方头像*/
            ,jwj.authorization_info            /* 授权信息*/
            ,jwj.authorizer_refresh_token      /* 刷新token*/
            ,jwj.token						 /* 令牌 */
            ,jwj.qrcodeimg                     /* 二维码图片*/
            ,jwj.authorization_status			 /* 授权状态 */
		FROM   	 jw_web_jwid      AS jwj      /*  */ 
		WHERE jwj.jwid = #{jwid}
	</select>
</mapper>